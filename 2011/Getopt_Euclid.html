<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Pod::Advent 0.24 (Pod::Simple 3.07, Perl::Tidy 20101217) on 2011-12-04 10:52:13 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>2011 Perl Advent Calendar: Getopt::Euclid</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../style.css" type="text/css" />
<link rel="alternate" type="text/plain" href="Getopt_Euclid.pod" />
</head>
<body>
<h1><a href="../">Perl Advent Calendar 2011-12</a>-04</h1>
<h2 align="center">Getopt::Euclid</h2>
<h3 align="center">by Joe Jiang</h3>
<p>写脚本的时候，最麻烦的两件事，无非是写文档和设计用户接口。有了 Getopt::Euclid，这两件事情居然开始变得十分有趣了。应该说，文档驱>动的程序，这样的创意并不少见，可是用来作为用户接口，这真的还是让人觉得十分恰当。</p>
<p>相比其他的脚本参数分析模块，这个模块的知名度比较低，不过它的作者 Damian Conway 还是十分知名的。现在的维护者 Florent Angly 看起来 也是参数模块这方面的爱好者，一同被他收纳的还有 Getopt::Declare。</p>
<p>具体的使用方法可以参考以下的测试代码：</p>
<pre>
    <span class="c">#!/usr/bin/perl -wl</span>

    <span class="k">use</span> <span class="w">Getopt::Euclid</span><span class="sc">;</span>
    <span class="k">print</span> <span class="k">for</span> <span class="i">@</span>{<span class="i">$ARGV</span>{-<span class="w">i</span>}}<span class="sc">;</span>

    =<span class="w">head1</span> <span class="w">NAME</span>

    <span class="w">demo</span>-<span class="w">euclid</span> - <span class="w">testing</span> <span class="w">of</span> <span class="w">module</span> <span class="w">Getopt::Euclid</span>

    =<span class="w">head1</span> <span class="w">VERSION</span>

    <span class="w">This</span> <span class="w">documentation</span> <span class="w">refers</span> <span class="w">to</span> <span class="w">demo</span>-<span class="w">euclid</span> <span class="w">version</span> <span class="v">0.0.1</span>

    =<span class="w">head1</span> <span class="w">USAGE</span>

        <span class="w">demo</span>-<span class="w">euclid</span> <span class="s">[</span><span class="w">options</span><span class="s">]</span>  -<span class="w">i</span><span class="s">[</span><span class="w">n</span><span class="s">]</span><span class="s">[</span><span class="w">file</span><span class="s">]</span> <span class="q">&lt;file&gt;</span>

    =<span class="w">head1</span> <span class="w">REQUIRED</span> <span class="w">ARGUMENTS</span>

    =<span class="w">over</span>

    =<span class="w">item</span>  -<span class="w">i</span><span class="s">[</span><span class="w">n</span><span class="s">]</span><span class="s">[</span><span class="w">file</span><span class="s">]</span> <span class="q">&lt;file&gt;</span>

    <span class="w">Specify</span> <span class="w">input</span> <span class="w">file</span>

    =<span class="k">for</span> <span class="w">Euclid</span><span class="co">:</span>
        <span class="w">repeatable</span>
        <span class="w">file</span>.<span class="w">type</span><span class="co">:</span>    <span class="w">readable</span>
        <span class="w">file</span>.<span class="w">default</span><span class="co">:</span> <span class="q">&#39;-&#39;</span>

    =<span class="w">back</span>
</pre>

<p>有了以上的代码，你就可以这样测试一下了：</p>
<pre>
    <span class="i">$ perl</span> <span class="w">demo</span>-<span class="w">euclid</span>.<span class="w">pl</span> --<span class="w">version</span>
    <span class="w">This</span> <span class="w">is</span> <span class="w">demo</span>-<span class="w">euclid</span>.<span class="w">pl</span> <span class="w">version</span> <span class="v">0.0.1</span>
</pre>

<p>看上去还不错，这个工具脚本已经可以自动汇报版本号了！然后再测试一下正式的功能：</p>
<pre>
    <span class="i">$ perl</span> <span class="w">demo</span>-<span class="w">euclid</span>.<span class="w">pl</span> -<span class="w">i</span> /<span class="w">etc</span>/<span class="w">passwd</span> -<span class="w">i</span> /<span class="w">etc</span>/<span class="w">group</span>
    /<span class="w">etc</span>/<span class="w">passwd</span>
    <span class="q">/etc/group</span>
</pre>

<p>这正是我们的工具需要的功能，也就是分行（因为 #! 行的末尾有个 l 选项）打印文件名。另外，文件不存在，或者不可读的时候，脚本还会自>动报错：</p>
<pre>
    <span class="i">$ perl</span> <span class="w">demo</span>-<span class="w">euclid</span>.<span class="w">pl</span> -<span class="w">i</span> /<span class="w">etc</span>/<span class="w">pass</span>
    <span class="w">Invalid</span> <span class="q">&quot;-i[n][file] &lt;file&gt;&quot;</span> <span class="w">argument</span>.
    <span class="q">&lt;file&gt;</span> <span class="w">must</span> <span class="w">be</span> <span class="w">readable</span> <span class="w">but</span> <span class="w">the</span> <span class="w">supplied</span> <span class="w">value</span> <span class="s">(</span><span class="q">&quot;/etc/pass&quot;</span><span class="s">)</span> <span class="w">isn&#39;t</span>.
    <span class="s">(</span><span class="w">Try</span><span class="co">:</span> <span class="w">demo</span>-<span class="w">euclid</span>.<span class="w">pl</span> --<span class="w">help</span><span class="s">)</span>

    <span class="i">$ perl</span> <span class="w">demo</span>-<span class="w">euclid</span>.<span class="w">pl</span> --<span class="w">help</span>
    <span class="w">Usage</span><span class="co">:</span>

    <span class="w">demo</span>-<span class="w">euclid</span>.<span class="w">pl</span> -<span class="w">i</span> <span class="q">&lt;file&gt;</span>
    ...
</pre>

<p>看上去还挺专业的，连相应的帮助信息也有了。衷心希望你会喜欢上这个小模块！</p>
<div style="float: right; font-size: 10pt"><a href="Getopt_Euclid.pod">View Source (POD)</a></div><br />
</body>
</html>
