<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Pod::Advent 0.24 (Pod::Simple 3.14, Perl::Tidy 20101217) on 2011-12-23 23:14:38 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<title>2011 Perl Advent Calendar: Getopt::Complete</title>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<link rel="stylesheet" href="../style.css" type="text/css" />
<link rel="alternate" type="text/plain" href="Getopt_Complete.pod" />
</head>
<body>
<h1><a href="../">Perl Advent Calendar 2011-12</a>-23</h1>
<h2 align="center">Getopt::Complete</h2>
<h3 align="center">by Joe Jiang</h3>
<p>这次介绍的是 Scott Smith 写的 <tt><a href="http://search.cpan.org/perldoc?Getopt::Complete" title="Getopt::Complete">Getopt::Complete</a></tt> 模块，它能帮助你设计更加易于记忆的命令行接口。</p>
<p>如果你喜欢在命令行做大多数事情的话，没准有一件事还没有尝试过，那就是用 w3m 浏览器查阅圣经。做这样的事情，最好的网站（目前来说）可能还是 YouVersion.com。因为他们有专门为手机浏览器设计的页面 m.youversion.com。当然，那里还有圣经的手机应用可以下载。</p>
<p>现在的问题是，要准确拼凑 URL 字符串很不容易，不过有了 Getopt::Complete 就不是什么大问题了。</p>
<p>如果你装好了这个模块，又有这样一段可执行脚本（命名为 youversion）在可执行路径下：</p>
<pre>
    <span class="c">#!/usr/bin/perl</span>
    
    <span class="k">use</span> <span class="w">Getopt::Complete</span> <span class="s">(</span>
        <span class="w">book</span> <span class="cm">=&gt;</span> <span class="s">[</span><span class="q">qw(gen exod lev num deut josh judg ruth 1sam 2sam 1kgs 2kgs 1chr 2chr ezra neh esth job ps prov eccl song isa jer lam ezek dan hos joel amos obad jonah mic nah hab zeph hag zech mal matt mark luke john acts rom 1cor 2cor gal eph phil col 1thess 2thess 1tim 2tim titus phlm heb jas 1pet 2pet 1john 2john 3john jude rev)</span><span class="s">]</span><span class="cm">,</span>
        <span class="w">translation</span> <span class="cm">=&gt;</span> <span class="s">[</span><span class="q">qw(cunpss cnvs ccb csb niv nlt esv kjv nkjv net web msg cev ncv)</span><span class="s">]</span><span class="cm">,</span>
        <span class="w">chapter</span> <span class="cm">=&gt;</span> <span class="k">undef</span><span class="cm">,</span>
        <span class="q">&#39;verse&#39;</span> <span class="cm">=&gt;</span> <span class="k">undef</span><span class="cm">,</span>
    <span class="s">)</span><span class="sc">;</span>
    
    <span class="k">system</span> <span class="q">qq(w3m http://zh-cn.m.youversion.com/bible/verse/@{[$ARGS{translation} || q(cunpss)]}/@{[$ARGS{book} || q(heb)]}/@{[$ARGS{chapter} || 1]}/$ARGS{verse})</span><span class="sc">;</span>
</pre>

<p>那么你就可以在输入 youversion 这个词（包括空格）以后按下 TAB 键两次，这时候就会自动补齐 --。然后呢？再次双 TAB！</p>
<pre>
    <span class="i">%  youversion</span> --
    --<span class="w">book</span>=         --<span class="w">chapter</span>=      --<span class="w">translation</span>=  --<span class="w">verse</span>=
</pre>

<p>现在你看到了所有的可选参数，输入 b 然后再次双 TAB，你会看到自动补齐了 book=。没错，再次双 TAB。</p>
<pre>
    <span class="i">%  youversion</span> --<span class="w">book</span>=
    <span class="n">1</span><span class="k">chr</span>    <span class="n">2</span><span class="k">chr</span>    <span class="n">3</span><span class="w">john</span>   <span class="w">esth</span>    <span class="w">heb</span>     <span class="w">jonah</span>   <span class="w">mark</span>    <span class="w">phlm</span>    <span class="w">zech</span>
    <span class="n">1</span><span class="w">cor</span>    <span class="n">2</span><span class="w">cor</span>    <span class="w">acts</span>    <span class="w">exod</span>    <span class="w">hos</span>     <span class="w">josh</span>    <span class="w">matt</span>    <span class="w">prov</span>    <span class="w">zeph</span>
    <span class="n">1</span><span class="w">john</span>   <span class="n">2</span><span class="w">john</span>   <span class="w">amos</span>    <span class="w">ezek</span>    <span class="w">isa</span>     <span class="w">jude</span>    <span class="w">mic</span>     <span class="w">ps</span>
    <span class="n">1</span><span class="w">kgs</span>    <span class="n">2</span><span class="w">kgs</span>    <span class="w">col</span>     <span class="w">ezra</span>    <span class="w">jas</span>     <span class="w">judg</span>    <span class="w">nah</span>     <span class="w">rev</span>
    <span class="n">1</span><span class="w">pet</span>    <span class="n">2</span><span class="w">pet</span>    <span class="w">dan</span>     <span class="w">gal</span>     <span class="w">jer</span>     <span class="w">lam</span>     <span class="w">neh</span>     <span class="w">rom</span>
    <span class="n">1</span><span class="w">sam</span>    <span class="n">2</span><span class="w">sam</span>    <span class="w">deut</span>    <span class="w">gen</span>     <span class="w">job</span>     <span class="w">lev</span>     <span class="w">num</span>     <span class="w">ruth</span>
    <span class="n">1</span><span class="w">thess</span>  <span class="n">2</span><span class="w">thess</span>  <span class="w">eccl</span>    <span class="w">hab</span>     <span class="w">joel</span>    <span class="w">luke</span>    <span class="w">obad</span>    <span class="w">song</span>
    <span class="n">1</span><span class="w">tim</span>    <span class="n">2</span><span class="w">tim</span>    <span class="w">eph</span>     <span class="w">hag</span>     <span class="w">john</span>    <span class="w">mal</span>     <span class="w">phil</span>    <span class="w">titus</span>
</pre>

<p>现在列出了六十六个可选书名。我应该不用再教你怎么补齐其中一个了吧？</p>
<p>当然，并非每个参数都是必须的，有些参数是自动设为一的，比如章节号码。</p>
<p>于是，你可以继续不断尝试输入 TAB 和字母数字，最后也许你会输入这样的一串：</p>
<pre>
    <span class="i">% youversion</span> --<span class="w">book</span>=<span class="w">luke</span> --<span class="w">chapter</span>=<span class="n">2</span> --<span class="w">verse</span>=<span class="n">11</span>
</pre>

<p>那么回车之后你应该看到：</p>
<pre><span class="c">    今天在大卫的城里，为你们生了救主，就是主基督。</span></pre>
<p>提前祝大家圣诞快乐！神祝福 ...</p>
<div style="float: right; font-size: 10pt"><a href="Getopt_Complete.pod">View Source (POD)</a></div><br />
</body>
</html>
