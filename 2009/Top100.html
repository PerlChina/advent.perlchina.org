<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- Generated by Pod::Advent 0.18 (Pod::Simple 3.07, Perl::Tidy 20071205) on 2009-12-23 21:06:10 -->
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="content-type" content="text/html; charset=utf-8" />
<title>2009 CN Perl Advent Calendar: CPANDB</title>
<link rel="stylesheet" href="../style.css" type="text/css" />
<link rel="alternate" type="text/plain" href="Top100.pod" />
</head>
<body>
<h1><a href="../">CN Perl Advent Calendar 2009-12</a>-23</h1>
<h2 align="center">CPANDB</h2>
<h3 align="center">by Fayland Lam</h3>
<p>CPAN 数据是笔财富，而 <tt><a href="http://search.cpan.org/perldoc?CPANDB">CPANDB</a></tt> 是这笔财富的一个入口。</p>
<p>对 CPANDB 的一个直接应用是 <tt><a href="http://search.cpan.org/perldoc?CPAN::WWW::Top100::Generator">CPAN::WWW::Top100::Generator</a></tt> 而对应的网站是 <a href="http://ali.as/top100/">http://ali.as/top100/</a>。这个网站包括了一些 CPAN 上依赖最重，被依赖最重或失败最多的一批模块列表。</p>
<p>下面的代码可以得到类似 <a href="http://cpants.perl.org/dist/used_by/Moose">http://cpants.perl.org/dist/used_by/Moose</a> 的结果</p>
<pre>
<span class="k">use</span> <span class="w">CPANDB</span><span class="sc">;</span>

<span class="k">my</span> <span class="i">$moose_prereq</span> = <span class="w">CPANDB::Requires</span><span class="w">-&gt;select</span><span class="s">(</span>
    <span class="q">&#39;where module=?&#39;</span><span class="cm">,</span>
    <span class="q">&#39;Moose&#39;</span>
<span class="s">)</span><span class="sc">;</span>

<span class="k">foreach</span> <span class="k">my</span> <span class="i">$prereq</span> <span class="s">(</span> <span class="i">@$moose_prereq</span> <span class="s">)</span> <span class="s">{</span>
    <span class="k">my</span> <span class="i">$dist_name</span> = <span class="i">$prereq</span><span class="i">-&gt;distribution</span><span class="sc">;</span>
    <span class="k">print</span> <span class="q">&quot;$dist_name\n&quot;</span><span class="sc">;</span>
<span class="s">}</span>
</pre>

<p>如上只是个简单的应用，找到所有依赖 Moose 的模块。在 <tt><a href="http://search.cpan.org/perldoc?Task::Padre::Plugins">Task::Padre::Plugins</a></tt> 里，我们就是用类似的方法找出所有应该 Padre 的 Plugins. 脚本请参考 <a href="http://svn.perlide.org/padre/trunk/Task-Padre-Plugins/auto_generate.pl">http://svn.perlide.org/padre/trunk/Task-Padre-Plugins/auto_generate.pl</a></p>
<p>更多的应用可以参考 CPANDB 的文档，查看该 SQLite 的数据结构。</p>
<p>谢谢。</p>
<div style="float: right; font-size: 10pt"><a href="Top100.pod">View Source (POD)</a></div><br />
</body>
</html>
